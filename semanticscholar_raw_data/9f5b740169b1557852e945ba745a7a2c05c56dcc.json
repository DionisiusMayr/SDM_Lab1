{"paperId": "9f5b740169b1557852e945ba745a7a2c05c56dcc", "publicationVenue": {"id": "1901e811-ee72-4b20-8f7e-de08cd395a10", "name": "arXiv.org", "alternate_names": ["ArXiv"], "issn": "2331-8422", "url": "https://arxiv.org"}, "title": "Stateful Large Language Model Serving with Pensieve", "abstract": "Large Language Models (LLMs) have recently experienced great success, as evident in the widespread popularity of ChatGPT. Existing LLM serving systems are stateless across requests. Consequently, when LLMs are used in the common setting of multi-turn conversations, a growing log of the conversation history must be processed alongside any request by the serving system at each turn, resulting in repeated history processing. In this paper, we design $Pensieve$, a system optimized for multi-turn conversation LLM serving. $Pensieve$ maintains the conversation state across requests by caching previously processed history to avoid duplicate processing. $Pensieve$'s multi-tier caching strategy can utilize both GPU and CPU memory to efficiently store and retrieve cached data. $Pensieve$ also generalizes the recent PagedAttention kernel to support attention between multiple input tokens with a GPU cache spread over non-contiguous memory. Our evaluation shows that $Pensieve$ is able to achieve 1.51-1.95x throughput compared to vLLM and reduce latency by 60-75%.", "venue": "arXiv.org", "year": 2023, "fieldsOfStudy": ["Computer Science"], "publicationTypes": ["JournalArticle"], "publicationDate": "2023-12-09", "journal": {"name": "ArXiv", "volume": "abs/2312.05516"}, "authors": [{"authorId": "2490788", "name": "Lingfan Yu"}, {"authorId": "2273473304", "name": "Jinyang Li"}], "citations": [{"paperId": "8ab5a5d05eb825b24eaca9bcbb7c25d5f0077ec2", "title": "AttentionStore: Cost-effective Attention Reuse across Multi-turn Conversations in Large Language Model Serving"}]}
